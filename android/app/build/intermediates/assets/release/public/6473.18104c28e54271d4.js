"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6473],{6473:(D,m,i)=>{i.r(m),i.d(m,{ReviewsPageModule:()=>S});var d=i(6814),f=i(6223),a=i(878),g=i(9634),h=i(5861),_=i(9315),e=i(9212),v=i(1762),p=i(2333),P=i(2759),M=i(2042),C=i(2471);function O(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",2),e._UZ(3,"ion-back-button",3),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Rese\xf1as"),e.qZA(),e.TgZ(6,"ion-buttons",4)(7,"ion-button",5),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.toggleDarkMode())}),e._UZ(8,"ion-icon",6),e.qZA(),e.TgZ(9,"ion-button",5),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.cerrarSesion())}),e._UZ(10,"ion-icon",7),e.qZA()()()()}if(2&n){const t=e.oxw();e.Tol(t.isDarkMode?"dark-theme":""),e.xp6(8),e.Q6J("name",t.isDarkMode?"sunny-outline":"moon-outline")}}function k(n,s){if(1&n&&(e.ynx(0),e.TgZ(1,"p"),e._uU(2,"Respuesta del restaurante:"),e.qZA(),e.TgZ(3,"p",13),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.Oqu(t.respuesta)}}function b(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-card-content")(5,"p"),e._uU(6),e._UZ(7,"ion-icon",11),e.qZA(),e.TgZ(8,"p"),e._uU(9),e.qZA(),e.TgZ(10,"p",12),e._uU(11),e.qZA(),e.TgZ(12,"p"),e._uU(13,"-------------------------------"),e.qZA(),e.YNc(14,k,5,1,"ng-container",10),e.TgZ(15,"ion-button",5),e.NdJ("click",function(){const c=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.responderResena(c))}),e._uU(16,"Responder"),e.qZA()()()}if(2&n){const t=s.$implicit,r=e.oxw(2);e.ekj("dark-theme",r.isDarkMode),e.xp6(2),e.Udp("color","#ff830f"),e.xp6(),e.Oqu(t.nombre),e.xp6(3),e.hij("",t.calificacion," "),e.xp6(3),e.Oqu(t.comentario),e.xp6(2),e.Oqu(t.id_reviews),e.xp6(3),e.Q6J("ngIf",t.respuesta)}}function R(n,s){1&n&&(e.TgZ(0,"div"),e._uU(1," No hay rese\xf1as disponibles. "),e.qZA())}const x=n=>({"dark-theme":n});function Z(n,s){if(1&n&&(e.TgZ(0,"ion-content",8),e.YNc(1,b,17,9,"ion-card",9)(2,R,2,0,"div",10),e.qZA()),2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(3,x,t.isDarkMode)),e.xp6(),e.Q6J("ngForOf",t.resenasFiltrados),e.xp6(),e.Q6J("ngIf",!t.resenasFiltrados||0===t.resenasFiltrados.length)}}const w=[{path:"",component:(()=>{var n;class s{constructor(r,o,c,l,u,U){this.reviewsService=r,this.authService=o,this.usuariosService=c,this.menuService=l,this.router=u,this.themeService=U,this.resenasFiltrados=[],this.getUserRole(),this.getResena(),this.isDarkMode=this.themeService.isDarkTheme()}ngOnInit(){this.componentes=this.menuService.getMenuOpts(),this.obtenerDetallesClientes()}getResena(){if("administrador"===this.rol||"encargado"===this.rol||"camarero"===this.rol){const r=this.authService.getUserEmail();null!==r?this.usuariosService.getIdEmpresaPorEmail(r).subscribe(o=>{if(200===o.code&&o.data&&o.data.id_empresa){const c=o.data.id_empresa;this.reviewsService.obtenerResenas().subscribe(l=>{Array.isArray(l)?(this.getResenas=l.filter(u=>u.id_empresa===c),this.resenasFiltrados=this.getResenas,this.obtenerDetallesClientes()):console.error("La respuesta del servicio de rese\xf1as no es v\xe1lida:",l)},l=>{console.error("Error al obtener rese\xf1as:",l)})}else console.error("No se pudo obtener el id_empresa del usuario:",o)},o=>{console.error("Error al obtener el id_empresa del usuario:",o)}):console.error("El email del usuario es nulo.")}else console.error("No tiene permiso para acceder a esta opci\xf3n.")}obtenerDetallesClientes(){const r=this.resenasFiltrados.map(o=>this.reviewsService.obtenerDetallesCliente(o.id_cliente));(0,_.D)(r).subscribe(o=>{o.forEach((c,l)=>{this.resenasFiltrados[l].nombreCliente=c.nombre_cliente})},o=>{console.error("Error al obtener detalles del cliente:",o)})}responderResena(r){var o=this;return(0,h.Z)(function*(){const c=yield o.reviewsService.mostrarCuadroDialogoParaRespuesta(r);null!==c?console.log("Respuesta recibida:",c):console.log("La respuesta est\xe1 vac\xeda o se cancel\xf3.")})()}abrirCuadroDialogo(r){return this.reviewsService.mostrarCuadroDialogoParaRespuesta(r).then(o=>(console.log("Respuesta enviada:",o),o)).catch(()=>null)}getUserRole(){this.rol=this.authService.getUserRole(),"administrador"===this.rol||"encargado"===this.rol||(console.error("Usuario con rol",this.rol,"no tiene permiso para acceder a esta opci\xf3n."),this.authService.logout().subscribe(()=>{localStorage.removeItem("role"),localStorage.removeItem("usuario"),this.router.navigate(["/inicio"])},r=>{console.error("Error al cerrar sesi\xf3n:",r)}))}toggleDarkMode(){this.isDarkMode=!this.isDarkMode,this.themeService.setDarkTheme(this.isDarkMode)}cerrarSesion(){this.authService.logout().subscribe()}}return(n=s).\u0275fac=function(r){return new(r||n)(e.Y36(v.Y),e.Y36(p.e),e.Y36(P.J),e.Y36(M.h),e.Y36(g.F0),e.Y36(C.f))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-reviews"]],decls:2,vars:2,consts:[[3,"class",4,"ngIf"],["class","ion-padding",3,"ngClass",4,"ngIf"],["slot","start"],["defaultHref","/home",2,"--color","#ff830f"],["slot","end"],[3,"click"],[2,"color","#ff830f","font-size","24px",3,"name"],["name","log-out-outline","size","large",1,"color-salir"],[1,"ion-padding",3,"ngClass"],[3,"dark-theme",4,"ngFor","ngForOf"],[4,"ngIf"],["name","star-half-outline",2,"color","#ff830f"],[2,"display","none"],[1,"respuesta"]],template:function(r,o){1&r&&e.YNc(0,O,11,3,"ion-header",0)(1,Z,3,5,"ion-content",1),2&r&&(e.Q6J("ngIf","administrador"===o.rol||"encargado"===o.rol),e.xp6(),e.Q6J("ngIf","administrador"===o.rol||"encargado"===o.rol))},dependencies:[d.mk,d.sg,d.O5,a.YG,a.Sm,a.PM,a.FN,a.Zi,a.Dq,a.W2,a.Gu,a.gu,a.wd,a.sr,a.oU],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{font-size:18px}.custom-trash-icon[_ngcontent-%COMP%]{float:right;background-color:red;color:#fff}.star-icon[_ngcontent-%COMP%]{font-size:24px;color:gold}label[_ngcontent-%COMP%], ion-label[_ngcontent-%COMP%], p[_ngcontent-%COMP%], ion-card-title[_ngcontent-%COMP%]{color:#000}ion-card-title[_ngcontent-%COMP%]{font-size:2.2em}ion-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.5em}ion-icon[_ngcontent-%COMP%], ion-text[_ngcontent-%COMP%]{color:#ff830f!important}.dark-theme[_ngcontent-%COMP%]{--background: #444852;--color: #ffffff;--dark-background-color: #333;--dark-text-color: #fff;--dark-border-color: #555}.dark-theme[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: #444852;color:#fff}.dark-theme[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%], .dark-theme[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{--background: #343541}.dark-theme[_ngcontent-%COMP%]   ion-list.md.list-md.hydrated[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%], .dark-theme[_ngcontent-%COMP%]   .list-md[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: #343541;color:#fff;border:none}.dark-theme[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%], .dark-theme[_ngcontent-%COMP%]   ion-buttonitem[_ngcontent-%COMP%], .dark-theme[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{--background: #444852;color:#fff}.dark-theme[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{--background: var(--dark-background-color);--color: var(--dark-text-color)}.dark-theme[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .dark-theme[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], .dark-theme[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff!important}.dark-theme[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:2.2em}ion-title[_ngcontent-%COMP%]{text-align:center}']}),s})()}];let T=(()=>{var n;class s{}return(n=s).\u0275fac=function(r){return new(r||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[g.Bz.forChild(w),g.Bz]}),s})(),S=(()=>{var n;class s{}return(n=s).\u0275fac=function(r){return new(r||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.ez,f.u5,a.Pc,T]}),s})()}}]);