"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4917],{4917:(y,m,l)=>{l.r(m),l.d(m,{RegistroPageModule:()=>E});var d=l(6814),t=l(6223),s=l(878),f=l(9634),p=l(5861),e=l(9212),h=l(2759),b=l(5038),Z=l(5619);let R=(()=>{var r;class n{constructor(){this.refreshSubject=new Z.X(!1)}startRefresh(){this.refreshSubject.next(!0)}stopRefresh(){this.refreshSubject.next(!1)}getRefreshObservable(){return this.refreshSubject.asObservable()}}return(r=n).\u0275fac=function(o){return new(o||r)},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),n})();function v(r,n){1&r&&(e.TgZ(0,"ion-label",19),e._uU(1,"Nombre requerido"),e.qZA())}function P(r,n){1&r&&(e.TgZ(0,"ion-label",19),e._uU(1,"Apellido requerido"),e.qZA())}function I(r,n){1&r&&(e.TgZ(0,"ion-label",19),e._uU(1,"Email requerido"),e.qZA())}function _(r,n){1&r&&(e.TgZ(0,"ion-label",19),e._uU(1,"Email no valido"),e.qZA())}function T(r,n){1&r&&(e.TgZ(0,"ion-label",19),e._uU(1,"Longitud m\xednima de 6 caracteres alfanum\xe9rico"),e.qZA())}function A(r,n){1&r&&(e.TgZ(0,"ion-label",19),e._uU(1,"Longitud minima de 6 caracteres"),e.qZA())}function w(r,n){1&r&&(e.TgZ(0,"ion-label",19),e._uU(1,"Confirmar Password"),e.qZA())}function q(r,n){1&r&&(e.TgZ(0,"ion-label",20),e._uU(1,"Los passwords no coinciden"),e.qZA())}const N=[{path:"",component:(()=>{var r;class n{constructor(o,i,a,g,c){this.formBuilder=o,this.alertController=i,this.userRegis=a,this.empresaRegis=g,this.refreshService=c,this.submitted=!1,this.ionicForm=this.formBuilder.group({nombre:new t.NI("",t.kI.compose([t.kI.required])),apellido:new t.NI("",t.kI.compose([t.kI.required])),email:new t.NI("",t.kI.compose([t.kI.required,t.kI.pattern("^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$")])),password:new t.NI("",t.kI.compose([t.kI.required,t.kI.minLength(6)])),confirmPassword:new t.NI("",t.kI.compose([t.kI.required,t.kI.minLength(6)])),rol:new t.NI("administrador",t.kI.compose([t.kI.required])),id_empresa:new t.NI("",t.kI.compose([t.kI.required]))},{validators:this.MustMatch("password","confirmPassword")})}ngOnInit(){this.empresaRegis.getUltimaEmpresa().subscribe(o=>{var i;o&&200===o.code?(this.idEmpresaSeleccionada=o.data.id_empresa,null===(i=this.ionicForm.get("id_empresa"))||void 0===i||i.setValue(this.idEmpresaSeleccionada)):console.error("Error al obtener la \xfaltima empresa:",o?o.error:"Respuesta no v\xe1lida")},o=>{console.error("Error al obtener la \xfaltima empresa:",o)})}initiateRefresh(){this.refreshService.startRefresh()}get f(){return this.ionicForm.controls}MustMatch(o,i){return a=>{const c=a.controls[i];c.errors&&!c.errors.MustMatch||c.setErrors(a.controls[o].value!==c.value?{MustMatch:!0}:null)}}errorControl(){return this.ionicForm.controls}alert(o){console.log(o.target),console.log({nombre:o.target.nombre,apellido:o.target.apellido,email:o.target.email,password:o.target.password,rol:o.target.rol}),this.submitted=!0}enviarDatos(){this.submitted=!0,this.ionicForm.invalid?console.log("Formulario no v\xe1lido. Deteniendo env\xedo de datos."):this.userRegis.registroUsuario(this.ionicForm.value).subscribe(o=>{this.registros=o,"NO"===this.registros.authorized?(console.log("Mostrando alerta de error..."),this.mostrarAlertaNO("Error","Email ya registrado")):this.mostrarAlertaOK("Enhorabuena","Usuario creado correctamente")},o=>{console.error("Error en la solicitud:",o),console.log("Mostrando alerta de error en la solicitud..."),this.mostrarAlertaNO("Error","Email ya registrado")})}mostrarAlertaOK(o,i){var a=this;return(0,p.Z)(function*(){yield(yield a.alertController.create({header:o,message:i,buttons:[{text:"OK",handler:()=>{window.location.href="/login"}}],cssClass:"custom-alert-header"})).present()})()}mostrarAlertaNO(o,i){var a=this;return(0,p.Z)(function*(){yield(yield a.alertController.create({header:o,message:i,buttons:["OK"],cssClass:"custom-alert-header"})).present()})()}}return(r=n).\u0275fac=function(o){return new(o||r)(e.Y36(t.qu),e.Y36(s.Br),e.Y36(h.J),e.Y36(b.P),e.Y36(R))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-registro"]],decls:45,vars:9,consts:[["slot","start"],["href","/inicio"],["src","./../../../assets/img/ic-inicio.png",2,"width","84px"],[1,"ion-text-center"],[3,"formGroup","ngSubmit"],["lines","full"],["position","floating"],["type","text","formControlName","nombre"],["class","errormessage","position","floating",4,"ngIf"],["type","text","formControlName","apellido"],["type","text","formControlName","email"],["type","password","formControlName","password"],["type","password","formControlName","confirmPassword"],["style","margin-bottom: 10px;","class","errormessage","position","floating",4,"ngIf"],["lines","full",2,"display","none"],["type","text","formControlName","rol"],["type","hidden","formControlName","id_empresa"],[1,"custom-button",3,"click"],["href","/registro",2,"color","#fff"],["position","floating",1,"errormessage"],["position","floating",1,"errormessage",2,"margin-bottom","10px"]],template:function(o,i){1&o&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"a",1),e._UZ(4,"img",2),e.qZA()(),e.TgZ(5,"ion-title",3),e._uU(6,"Registro"),e.qZA()()(),e.TgZ(7,"ion-content")(8,"form",4),e.NdJ("ngSubmit",function(){return i.enviarDatos()}),e.TgZ(9,"ion-item",5)(10,"ion-label",6),e._uU(11,"Nombre"),e.qZA(),e._UZ(12,"ion-input",7),e.qZA(),e.YNc(13,v,2,0,"ion-label",8),e.TgZ(14,"ion-item",5)(15,"ion-label",6),e._uU(16,"Apellido"),e.qZA(),e._UZ(17,"ion-input",9),e.qZA(),e.YNc(18,P,2,0,"ion-label",8),e.TgZ(19,"ion-item",5)(20,"ion-label",6),e._uU(21,"Email"),e.qZA(),e._UZ(22,"ion-input",10),e.qZA(),e.YNc(23,I,2,0,"ion-label",8)(24,_,2,0,"ion-label",8),e.TgZ(25,"ion-item",5)(26,"ion-label",6),e._uU(27,"Password"),e.qZA(),e._UZ(28,"ion-input",11),e.qZA(),e.YNc(29,T,2,0,"ion-label",8)(30,A,2,0,"ion-label",8),e.TgZ(31,"ion-item",5)(32,"ion-label",6),e._uU(33,"Confirmaci\xf3n Password"),e.qZA(),e._UZ(34,"ion-input",12),e.YNc(35,w,2,0,"ion-label",8)(36,q,2,0,"ion-label",13),e.qZA(),e.TgZ(37,"ion-item",14),e._UZ(38,"ion-input",15),e.qZA(),e._UZ(39,"ion-input",16),e.TgZ(40,"ion-row")(41,"ion-col")(42,"ion-button",17),e.NdJ("click",function(){return i.enviarDatos()}),e.TgZ(43,"a",18),e._uU(44," Registro "),e.qZA()()()()()()),2&o&&(e.xp6(8),e.Q6J("formGroup",i.ionicForm),e.xp6(5),e.Q6J("ngIf",null!=i.f.nombre.getError("required")),e.xp6(5),e.Q6J("ngIf",null!=i.f.apellido.getError("required")),e.xp6(5),e.Q6J("ngIf",null!=i.f.email.getError("required")),e.xp6(),e.Q6J("ngIf",null!=i.f.email.getError("pattern")),e.xp6(5),e.Q6J("ngIf",null!=i.f.password.getError("required")),e.xp6(),e.Q6J("ngIf",null!=i.f.password.getError("minLength")),e.xp6(5),e.Q6J("ngIf",null!=i.f.confirmPassword.getError("required")),e.xp6(),e.Q6J("ngIf",null!=i.f.confirmPassword.getError("MustMatch")))},dependencies:[d.O5,t._Y,t.JJ,t.JL,s.YG,s.Sm,s.wI,s.W2,s.Gu,s.pK,s.Ie,s.Q$,s.Nd,s.wd,s.sr,s.j9,t.sg,t.u],styles:['@charset "UTF-8";form[_ngcontent-%COMP%]{margin:20px}p[_ngcontent-%COMP%]{font-family:Lato}input.ng-touched.ng-invalid[_ngcontent-%COMP%]{border:1px solid red}ion-button.custom-button[_ngcontent-%COMP%]{background-color:#ff830f;color:#fff;border-radius:10px}']}),n})()}];let U=(()=>{var r;class n{}return(r=n).\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[f.Bz.forChild(N),f.Bz]}),n})(),E=(()=>{var r;class n{}return(r=n).\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[d.ez,t.u5,s.Pc,t.UX,U]}),n})()}}]);