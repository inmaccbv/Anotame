"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9925],{9925:(E,f,l)=>{l.r(f),l.d(f,{AddempresaPageModule:()=>N});var d=l(6814),r=l(6223),a=l(878),u=l(9634),m=l(5861),e=l(9212),_=l(5038),A=l(4484),Z=l(2333),h=l(2471);function v(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title",3),e._uU(5,"Add Restaurante"),e.qZA(),e.TgZ(6,"ion-buttons",4)(7,"ion-button",5),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.toggleDarkMode())}),e._UZ(8,"ion-icon",6),e.qZA(),e.TgZ(9,"ion-button",5),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.cerrarSesion())}),e._UZ(10,"ion-icon",7),e.qZA()()()()}if(2&o){const n=e.oxw();e.Tol(n.isDarkMode?"dark-theme":""),e.xp6(8),e.Q6J("name",n.isDarkMode?"sunny-outline":"moon-outline")}}function b(o,s){1&o&&(e.TgZ(0,"ion-label",27),e._uU(1,"Cif empresa requerido"),e.qZA())}function P(o,s){1&o&&(e.TgZ(0,"ion-label",27),e._uU(1,"Cif no valido"),e.qZA())}function T(o,s){1&o&&(e.TgZ(0,"ion-label",27),e._uU(1,"Nombre empresa requerido"),e.qZA())}function I(o,s){1&o&&(e.TgZ(0,"ion-label",27),e._uU(1,"Direccion requerido"),e.qZA())}function x(o,s){if(1&o&&(e.TgZ(0,"ion-select-option",28),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n.provincia),e.xp6(),e.Oqu(n.provincia)}}function q(o,s){1&o&&(e.TgZ(0,"ion-label",27),e._uU(1,"Ciudad requerida"),e.qZA())}function C(o,s){1&o&&(e.TgZ(0,"ion-label",27),e._uU(1,"Codigo Postal requerido"),e.qZA())}function M(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"ion-content")(1,"form",8),e.NdJ("ngSubmit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.enviarDatos())}),e.TgZ(2,"ion-item",9)(3,"ion-label",10),e._uU(4,"CIF Empresa"),e.qZA(),e._UZ(5,"ion-input",11),e.qZA(),e.YNc(6,b,2,0,"ion-label",12)(7,P,2,0,"ion-label",12),e.TgZ(8,"ion-item",9)(9,"ion-label",10),e._uU(10,"Nombre Empresa"),e.qZA(),e._UZ(11,"ion-input",13),e.qZA(),e.YNc(12,T,2,0,"ion-label",12),e.TgZ(13,"ion-item",9)(14,"ion-label",10),e._uU(15,"Direccion"),e.qZA(),e._UZ(16,"ion-input",14),e.qZA(),e.YNc(17,I,2,0,"ion-label",12),e.TgZ(18,"ion-item",9)(19,"ion-label",10),e._uU(20,"Provincia"),e.qZA(),e.TgZ(21,"ion-select",15),e.YNc(22,x,2,2,"ion-select-option",16),e.qZA()(),e.TgZ(23,"ion-item",9)(24,"ion-label",10),e._uU(25,"Ciudad"),e.qZA(),e._UZ(26,"ion-input",17),e.qZA(),e.YNc(27,q,2,0,"ion-label",12),e.TgZ(28,"ion-item",9)(29,"ion-label",10),e._uU(30,"Codigo Postal"),e.qZA(),e._UZ(31,"ion-input",18),e.qZA(),e.YNc(32,C,2,0,"ion-label",12),e.TgZ(33,"ion-item",9)(34,"ion-label",10),e._uU(35,"Tipo de Restaurante"),e.qZA(),e.TgZ(36,"ion-select",19)(37,"ion-select-option",20),e._uU(38,"Italiano"),e.qZA(),e.TgZ(39,"ion-select-option",21),e._uU(40,"Mexicano"),e.qZA(),e.TgZ(41,"ion-select-option",22),e._uU(42,"Asi\xe1tico"),e.qZA(),e.TgZ(43,"ion-select-option",23),e._uU(44,"Mediterr\xe1neo"),e.qZA(),e.TgZ(45,"ion-select-option",24),e._uU(46,"Indio"),e.qZA()()(),e.TgZ(47,"ion-row")(48,"ion-col")(49,"ion-button",25),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.enviarDatos())}),e.TgZ(50,"a",26),e._uU(51," Add Restaurante "),e.qZA()()()()()()}if(2&o){const n=e.oxw();e.Tol(n.isDarkMode?"dark-theme":""),e.xp6(),e.Q6J("formGroup",n.empresaForm),e.xp6(5),e.Q6J("ngIf",null!=n.f.cif.getError("required")),e.xp6(),e.Q6J("ngIf",null!=n.f.cif.getError("pattern")),e.xp6(5),e.Q6J("ngIf",null!=n.f.empresa.getError("required")),e.xp6(5),e.Q6J("ngIf",null!=n.f.direccion.getError("required")),e.xp6(5),e.Q6J("ngForOf",n.provincias),e.xp6(5),e.Q6J("ngIf",null!=n.f.ciudad.getError("required")),e.xp6(5),e.Q6J("ngIf",null!=n.f.cPostal.getError("required"))}}const U=[{path:"",component:(()=>{var o;class s{constructor(t,i,c,p,g,y,O){this.formBuilder=t,this.alertController=i,this.router=c,this.empresaRegis=p,this.provinciasService=g,this.authService=y,this.themeService=O,this.submitted=!1,this.empresaForm=this.formBuilder.group({cif:new r.NI("",r.kI.compose([r.kI.required,r.kI.pattern("[A-Za-z]{1}[0-9]{8}")])),empresa:new r.NI("",r.kI.compose([r.kI.required])),direccion:new r.NI("",r.kI.compose([r.kI.required])),provincia:new r.NI("",r.kI.compose([r.kI.required])),ciudad:new r.NI("",r.kI.compose([r.kI.required])),cPostal:new r.NI("",r.kI.compose([r.kI.required])),tipoLocal:new r.NI("",r.kI.compose([r.kI.required]))}),this.getUserRole(),this.isDarkMode=this.themeService.isDarkTheme()}getUserRole(){this.rol=this.authService.getUserRole(),"administrador"!==this.rol&&(console.error("Usuario con rol",this.rol,"no tiene permiso para acceder a esta opci\xf3n."),this.authService.logout().subscribe(()=>{localStorage.removeItem("role"),localStorage.removeItem("usuario"),this.router.navigate(["/inicio"])},t=>{console.error("Error al cerrar sesion:",t)}))}get f(){return this.empresaForm.controls}enviarDatos(){var t=this;return(0,m.Z)(function*(){if(t.submitted=!0,!t.empresaForm.invalid)try{const i=yield t.empresaRegis.registroEmpresa(t.empresaForm.value).toPromise();console.log("Respuesta del servidor:",i),t.empresas=i,"NO"===t.empresas.authorized?t.mostrarAlertaNO("Error","CIF ya registrado"):(localStorage.setItem("empresa",t.empresas.data.empresa),t.mostrarAlertaOK("Enhorabuena","Empresa registrada correctamente"),t.router.navigate(["/registro"]))}catch(i){console.error("Error en la solicitud:",i),t.mostrarAlertaNO("Error","Error al registrar empresa")}})()}mostrarAlertaOK(t,i){var c=this;return(0,m.Z)(function*(){yield(yield c.alertController.create({header:t,message:i,buttons:[{text:"OK",handler:()=>{const g=localStorage.getItem("empresa");console.log("Nombre de la empresa en localStorage:",g),window.location.href="/config-empleados"}}],cssClass:"custom-alert-header"})).present()})()}mostrarAlertaNO(t,i){var c=this;return(0,m.Z)(function*(){yield(yield c.alertController.create({header:t,message:i,buttons:["OK"],cssClass:"custom-alert-header"})).present()})()}toggleDarkMode(){this.isDarkMode=!this.isDarkMode,this.themeService.setDarkTheme(this.isDarkMode)}cerrarSesion(){this.authService.logout().subscribe()}}return(o=s).\u0275fac=function(t){return new(t||o)(e.Y36(r.qu),e.Y36(a.Br),e.Y36(u.F0),e.Y36(_.P),e.Y36(A.g),e.Y36(Z.e),e.Y36(h.f))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-addempresa"]],decls:2,vars:2,consts:[[3,"class",4,"ngIf"],["slot","start"],["defaultHref","/config-empleados",2,"--color","#ff830f"],["color","primary"],["slot","end"],[3,"click"],[2,"color","#ff830f","font-size","24px",3,"name"],["name","log-out-outline","size","large",1,"color-salir"],[3,"formGroup","ngSubmit"],["lines","full"],["position","floating"],["type","text","formControlName","cif"],["class","errormessage","position","floating",4,"ngIf"],["type","text","formControlName","empresa"],["type","text","formControlName","direccion"],["type","select","formControlName","provincia"],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","ciudad"],["type","text","formControlName","cPostal"],["formControlName","tipoLocal"],["value","Italiano"],["value","Mexicano"],["value","Asi\xe1tico"],["value","Mediterr\xe1neo"],["value","Indio"],[1,"custom-button",3,"click"],["href","/config-empleados",2,"color","#fff"],["position","floating",1,"errormessage"],[3,"value"]],template:function(t,i){1&t&&e.YNc(0,v,11,3,"ion-header",0)(1,M,52,10,"ion-content",0),2&t&&(e.Q6J("ngIf","administrador"===i.rol),e.xp6(),e.Q6J("ngIf","administrador"===i.rol))},dependencies:[d.sg,d.O5,r._Y,r.JJ,r.JL,a.YG,a.Sm,a.wI,a.W2,a.Gu,a.gu,a.pK,a.Ie,a.Q$,a.Nd,a.t9,a.n0,a.wd,a.sr,a.QI,a.j9,a.oU,r.sg,r.u],styles:['@charset "UTF-8";form[_ngcontent-%COMP%]{margin:20px}p[_ngcontent-%COMP%]{font-family:Lato}.errormessage[_ngcontent-%COMP%]{color:red;font-size:12px}input.ng-touched.ng-invalid[_ngcontent-%COMP%]{border:1px solid red}ion-title[_ngcontent-%COMP%]{text-align:center}.color-salir[_ngcontent-%COMP%]{color:#ff830f}ion-button.custom-button[_ngcontent-%COMP%]{background-color:#ff830f;color:#fff;border-radius:10px}.dark-mode[_ngcontent-%COMP%]{background-color:#333;color:#000!important}.dark-mode-label[_ngcontent-%COMP%], .dark-mode-input[_ngcontent-%COMP%]{color:#fff!important}.custom-alert-header[_ngcontent-%COMP%]{color:#ff830f!important}']}),s})()}];let k=(()=>{var o;class s{}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.Bz.forChild(U),u.Bz]}),s})(),N=(()=>{var o;class s{}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[d.ez,r.u5,a.Pc,r.UX,k]}),s})()}}]);