"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7515],{7515:(F,g,l)=>{l.r(g),l.d(g,{ListauserPageModule:()=>Z});var u=l(6814),f=l(6223),n=l(878),m=l(9634),p=l(5861),e=l(9212),h=l(2759),b=l(2333),_=l(2042),v=l(2471);function P(t,c){if(1&t){const a=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",5),e._UZ(3,"ion-back-button",6),e.qZA(),e.TgZ(4,"ion-title",7),e._uU(5,"Lista Empleados"),e.qZA(),e.TgZ(6,"ion-buttons",8)(7,"ion-button",9),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.toggleDarkMode())}),e._UZ(8,"ion-icon",10),e.qZA(),e.TgZ(9,"ion-button",9),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.cerrarSesion())}),e._UZ(10,"ion-icon",11),e.qZA()()()()}if(2&t){const a=e.oxw();e.Tol(a.isDarkMode?"dark-theme":""),e.xp6(8),e.Q6J("name",a.isDarkMode?"sunny-outline":"moon-outline")}}const M=t=>({"dark-theme":t});function C(t,c){if(1&t){const a=e.EpF();e.TgZ(0,"ion-item",12)(1,"ion-label"),e._uU(2),e.qZA(),e.TgZ(3,"ion-label"),e._uU(4),e.qZA(),e.TgZ(5,"ion-buttons",8)(6,"ion-button",13),e.NdJ("click",function(){const i=e.CHM(a).$implicit,s=e.oxw();return e.KtG(s.borrarEmpleado(i.id_user))}),e._UZ(7,"ion-icon",14),e.qZA()()()}if(2&t){const a=c.$implicit,r=c.index,o=e.oxw();e.Udp("background-color",o.coloresFilas[r%o.coloresFilas.length]),e.Q6J("ngClass",e.VKq(5,M,o.isDarkMode)),e.xp6(2),e.Oqu(a.nombre),e.xp6(2),e.Oqu(a.email)}}const L=[{path:"",component:(()=>{var t;class c{constructor(r,o,i,s,d,E){this.router=r,this.alertController=o,this.userLogin=i,this.authService=s,this.menuService=d,this.themeService=E,this.empleados=[],this.coloresFilas=["#FFECBA","#FFFFFF"],this.getUserRole(),this.isDarkMode=this.themeService.isDarkTheme()}ngOnInit(){this.componentes=this.menuService.getMenuOpts(),this.getEmpleados()}getUserRole(){this.rol=this.authService.getUserRole(),"administrador"!==this.rol&&(console.error("Usuario con rol",this.rol,"no tiene permiso para acceder a esta opci\xf3n."),this.authService.logout().subscribe(()=>{localStorage.removeItem("role"),localStorage.removeItem("usuario"),this.router.navigate(["/inicio"])},r=>{console.error("Error al cerrar sesion:",r)}))}getEmpleados(){if("administrador"===this.rol||"encargado"===this.rol||"camarero"===this.rol){const r=this.authService.getUserEmail();null!==r?this.userLogin.getIdEmpresaPorEmail(r).subscribe(o=>{if(200===o.code&&o.data&&o.data.id_empresa){this.idEmpresa=o.data.id_empresa;const i=this.idEmpresa;isNaN(i)?console.error("ID de empresa no es un n\xfamero v\xe1lido:",i):this.userLogin.getUsuariosPorEmpresa(i).subscribe(s=>{200===s.code&&Array.isArray(s.data)?(this.empleados=s.data,this.empleadosFiltrados=s.data,console.log("Empleados obtenidos:",this.empleados)):console.error("La respuesta del servicio de empleados no es v\xe1lida:",s)},s=>{console.error("Error al obtener los empleados:",s)})}else console.error("No se pudo obtener el id_empresa del usuario:",o)},o=>{console.error("Error al obtener el id_empresa del usuario:",o)}):console.error("El email del usuario es nulo.")}else console.error("No tiene permiso para acceder a esta opci\xf3n.")}borrarEmpleado(r){var o=this;return(0,p.Z)(function*(){yield(yield o.alertController.create({header:"Confirmar",message:"\xbfEst\xe1s seguro de que deseas borrar este empleado?",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{console.log("Borrado cancelado")}},{text:"Borrar",handler:()=>{try{o.userLogin.borrarEmpleado(r).subscribe(function(){var s=(0,p.Z)(function*(d){console.log(d),window.location.reload()});return function(d){return s.apply(this,arguments)}}())}catch(s){console.error(s)}}}]})).present()})()}filtrarEmpleados(r,o){o||(o=""),this.empleadosFiltrados=this.empleados.filter(i=>{const s=o.toLowerCase();switch(r){case"nombre":return i.nombre.toLowerCase().includes(s);case"email":return i.email.toLowerCase().includes(s);default:return!1}})}toggleDarkMode(){this.isDarkMode=!this.isDarkMode,this.themeService.setDarkTheme(this.isDarkMode)}cerrarSesion(){this.authService.logout().subscribe()}}return(t=c).\u0275fac=function(r){return new(r||t)(e.Y36(m.F0),e.Y36(n.Br),e.Y36(h.J),e.Y36(b.e),e.Y36(_.h),e.Y36(v.f))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-listauser"]],decls:7,vars:2,consts:[[3,"class",4,"ngIf"],["placeholder","Buscar por nombre",3,"ionInput"],["placeholder","Buscar por correo electr\xf3nico",3,"ionInput"],["lines","none",1,"lista-empleados"],["class","itemUser",3,"ngClass","background-color",4,"ngFor","ngForOf"],["slot","start"],["defaultHref","/config-empleados",2,"--color","#ff830f"],["color","primary",2,"font-size","20px"],["slot","end"],[3,"click"],[2,"color","#ff830f","font-size","22px",3,"name"],["name","log-out-outline","size","large",1,"color-salir"],[1,"itemUser",3,"ngClass"],["fill","clear",3,"click"],["name","trash-outline",1,"iconos"]],template:function(r,o){1&r&&(e.YNc(0,P,11,3,"ion-header",0),e.TgZ(1,"ion-content")(2,"ion-toolbar")(3,"ion-searchbar",1),e.NdJ("ionInput",function(s){return o.filtrarEmpleados("nombre",s.target.value||"")}),e.qZA(),e.TgZ(4,"ion-searchbar",2),e.NdJ("ionInput",function(s){return o.filtrarEmpleados("email",s.target.value||"")}),e.qZA()(),e.TgZ(5,"ion-list",3),e.YNc(6,C,8,7,"ion-item",4),e.qZA()()),2&r&&(e.Q6J("ngIf","administrador"===o.rol),e.xp6(6),e.Q6J("ngForOf",o.empleadosFiltrados))},dependencies:[u.mk,u.sg,u.O5,n.YG,n.Sm,n.W2,n.Gu,n.gu,n.Ie,n.Q$,n.q_,n.VI,n.wd,n.sr,n.j9,n.oU],styles:['@charset "UTF-8";@font-face{font-family:restaurant;src:url(restaurant.1b01a82eee17a8b3.ttf) format("truetype");font-weight:400;font-style:normal}ion-label[_ngcontent-%COMP%]{font-family:cakecafe,sans-serif}.lista-empleados[_ngcontent-%COMP%]{margin-top:20px}ion-title[_ngcontent-%COMP%]{text-align:center;font-size:4vw}ion-toolbar[_ngcontent-%COMP%], ion-title[_ngcontent-%COMP%], ion-col[_ngcontent-%COMP%], ion-label[_ngcontent-%COMP%]{font-size:3vw}.iconos[_ngcontent-%COMP%]{font-size:6.5vw;color:#ff830f;overflow:visible}p.mostrar-abajo[_ngcontent-%COMP%]{display:block;position:absolute;background-color:#fff;padding:5px;border-radius:5px;box-shadow:0 0 10px #0000001a;margin-top:20px;z-index:1}.itemUser[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}.dark-theme[_ngcontent-%COMP%]   .itemUser[_ngcontent-%COMP%]{background-color:#333}.color-salir[_ngcontent-%COMP%]{color:#ff830f}']}),c})()}];let x=(()=>{var t;class c{}return(t=c).\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[m.Bz.forChild(L),m.Bz]}),c})(),Z=(()=>{var t;class c{}return(t=c).\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.ez,f.u5,n.Pc,x]}),c})()}}]);